<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Login ‚Ä¢ Sistema</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fontes / √çcones -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkfAmGNh9H2PS9e0m9QF0S/3VQG8H1m2HNp6f5p2l+Z8Y3GfP2vLQdESA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    :root{
      --bg:#f4f7f9;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#6b7280;
      --line:#e5e7eb;
      --primary:#3498db;
      --primary-600:#207ac2;
      --danger:#e11d48;

      --ok-bg:#d1e7dd; --ok-border:#badbcc; --ok-text:#0f5132;
      --err-bg:#fde2e7; --err-border:#f5c2c7; --err-text:#842029;

      /* ser√° preenchido inline quando houver imagem_2 */
      --bg-img:none;
    }
    *{ box-sizing:border-box }
    html,body{ margin:0 }
    body{
      min-height:100vh; display:flex; flex-direction:column; gap:16px;
      align-items:center; justify-content:center; padding:24px;
      background:var(--bg);
      font-family:'Roboto',system-ui,-apple-system,'Segoe UI',Roboto,sans-serif;
      color:var(--text);
      position:relative;
      overflow:hidden;
    }

    /* Background desfocado + overlay */
    .bg-blur{
      position:fixed; inset:-4%;           /* extrapola para evitar ‚Äúbordas‚Äù do blur */
      z-index:-2;
      background: var(--bg-img) center/cover no-repeat;
      filter: blur(14px) saturate(1.05);
      transform: scale(1.04);
      will-change: transform, filter;
    }
    .bg-overlay{
      position:fixed; inset:0;
      z-index:-1;
      /* scrim para legibilidade */
      background:
        radial-gradient(1000px 600px at 10% -10%, rgba(124,58,237,.20), transparent 60%),
        radial-gradient(900px 500px at 90% -20%, rgba(37,99,235,.20), transparent 60%),
        linear-gradient(180deg, rgba(3,7,18,.45), rgba(3,7,18,.25));
      pointer-events:none;
    }

    .card{
      width:100%; max-width:420px;
      background:var(--card);
      border:1px solid var(--line);
      border-radius:14px;
      box-shadow:0 10px 28px rgba(0,0,0,.10);
      padding:22px;
      transition:transform .2s ease;
      backdrop-filter: saturate(1.1);
    }
    .card:hover{ transform:translateY(-1px) }

    .logo{
      max-width:120px; height:auto; display:block; margin:0 auto 8px;
      border-radius:10px;
    }

    h1{
      margin:6px 0 14px; text-align:center; font-size:22px; font-weight:700; color:#1f2937;
    }

    /* Mensagens */
    .messages{ list-style:none; margin:0 0 12px; padding:0 }
    .msg{ border-radius:10px; padding:12px 14px; border:1px solid transparent; font-weight:500; margin-bottom:10px }
    .error{ background:var(--err-bg); border-color:var(--err-border); color:var(--err-text) }
    .success{ background:var(--ok-bg); border-color:var(--ok-border); color:var(--ok-text) }

    label{ display:block; font-weight:500; color:#374151; margin:10px 0 6px }

    .field{
      position:relative;
      background:#f9fafb;
      border:1px solid var(--line);
      border-radius:10px;
      padding:8px 12px;
      display:flex; align-items:center; gap:8px;
      transition:border-color .2s, box-shadow .2s, background .2s;
    }
    .field:focus-within{ border-color:var(--primary); box-shadow:0 0 0 3px rgba(52,152,219,.15); background:#fff }
    .field i{ color:#7b8694 }

    .field input{
      flex:1; min-width:0; border:0; outline:0;
      background:transparent; font-size:15px; color:var(--text);
      padding:6px 0;
    }

    .eye{
      border:none; background:transparent; cursor:pointer;
      font-size:18px; color:#7b8694; padding:4px 6px; border-radius:8px;
    }
    .eye:hover{ background:#eef2f7 }

    .errorlist{ margin:6px 0 0 0; padding-left:18px; color:var(--err-text); font-size:13px }

    .btn{
      width:100%;
      appearance:none; border:0; border-radius:10px;
      padding:12px 16px; font-weight:700; font-size:16px;
      background:var(--primary); color:#fff; cursor:pointer;
      box-shadow:0 6px 16px rgba(52,152,219,.25);
      transition:filter .2s, transform .03s ease-in;
      margin-top:8px;
    }
    .btn:hover{ filter:brightness(.97) }
    .btn:active{ transform:translateY(1px) }
    .btn[disabled]{ opacity:.7; cursor:not-allowed }

    .support{
      display:flex; justify-content:center; gap:10px; flex-wrap:wrap;
      width:100%; max-width:420px;
    }
    .support a{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 14px; border-radius:10px; color:#fff; text-decoration:none; font-weight:600;
      box-shadow:0 6px 16px rgba(0,0,0,.08); transition:filter .2s;
    }
    .wa{ background:#25d366 }
    .wa:hover{ filter:brightness(.95) }
    .mail{ background:#2563eb }
    .mail:hover{ filter:brightness(.95) }

    footer{
      text-align:center; color:#6b7280; font-size:12px; margin-top:6px;
      text-shadow:0 1px 2px rgba(0,0,0,.25);
    }
  </style>
</head>
<body
  {% if politica and politica.imagem_2 %}
    style="--bg-img: url('{{ politica.imagem_2.url }}');"
  {% endif %}
>

  {# fundo desfocado s√≥ aparece se houver imagem_2 #}
  {% if politica and politica.imagem_2 %}
    <div class="bg-blur" aria-hidden="true"></div>
    <div class="bg-overlay" aria-hidden="true"></div>
  {% endif %}

  <div class="card" {% if form.errors %}aria-live="polite"{% endif %}>
    {% if politica and politica.logo %}
      <img src="{{ politica.logo.url }}" alt="Logo" class="logo">
    {% endif %}

    <h1>Login</h1>

    {% if form.errors %}
      <div class="msg error"><i class="fa-solid fa-circle-exclamation"></i> Usu√°rio ou senha inv√°lidos.</div>
    {% endif %}

    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li class="msg {% if message.tags %}{{ message.tags }}{% endif %}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <form method="post" class="login-form" novalidate>
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ next }}"/>

      <label for="{{ form.username.id_for_label }}">Usu√°rio</label>
      <div class="field">
        <i class="fa-regular fa-user"></i>
        {{ form.username }}
      </div>
      {% if form.username.errors %}
        <ul class="errorlist">
          {% for error in form.username.errors %}<li>{{ error }}</li>{% endfor %}
        </ul>
      {% endif %}

      <label for="{{ form.password.id_for_label }}">Senha</label>
      <div class="field">
        <i class="fa-solid fa-key"></i>
        {{ form.password }}
        <button type="button" class="eye" data-eye="id_password" aria-label="Mostrar/ocultar senha">üëÅÔ∏è</button>
      </div>
      {% if form.password.errors %}
        <ul class="errorlist">
          {% for error in form.password.errors %}<li>{{ error }}</li>{% endfor %}
        </ul>
      {% endif %}

      <button type="submit" class="btn" id="btnSubmit">Entrar</button>
    </form>
  </div>

  <div class="support" aria-label="Canais de suporte">
    <a href="https://wa.me/5563920013103" class="wa" target="_blank" rel="noopener">
      <i class="fa-brands fa-whatsapp"></i> Suporte WhatsApp
    </a>
    <a href="mailto:alexandremv.dev@gmail.com" class="mail">
      <i class="fa-solid fa-envelope"></i> Suporte E-mail
    </a>
  </div>

  <footer>
    Sistema eismeaqui.app ‚Äî desenvolvido por Alexandre Martins Vieira
  </footer>

  <script>
    // Acessibilidade / UX: sugere autocomplete apropriado
    const u = document.getElementById('{{ form.username.id_for_label }}'.replace('id_', 'id_')) || document.getElementById('id_username');
    const p = document.getElementById('{{ form.password.id_for_label }}'.replace('id_', 'id_')) || document.getElementById('id_password');

    if(u){ u.setAttribute('autocomplete','username'); u.setAttribute('autocapitalize','none'); u.setAttribute('spellcheck','false'); }
    if(p){ p.setAttribute('autocomplete','current-password'); }

    // Mostrar/ocultar senha
    document.querySelectorAll('[data-eye]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-eye');
        const input = document.getElementById(id) || document.querySelector('input[name="password"]');
        if(!input) return;
        const isPwd = input.type === 'password';
        input.type = isPwd ? 'text' : 'password';
        btn.textContent = isPwd ? 'üôà' : 'üëÅÔ∏è';
        input.focus({preventScroll:true});
      });
    });

    // Evitar duplo envio
    (function(){
      const form = document.querySelector('.login-form');
      if(!form) return;
      form.addEventListener('submit', ()=>{
        const btn = document.getElementById('btnSubmit');
        if(btn){ btn.textContent = 'Entrando‚Ä¶'; btn.setAttribute('disabled','disabled'); }
      });
    })();

    // Auto foco amig√°vel
    if(u && !u.value){ u.focus(); } else if(p && !p.value){ p.focus(); }
  </script>
</body>
</html>
